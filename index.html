<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Mini App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>

    <h1>My Mini App</h1>

    <div id="data-display">
        </div>

    <br>

    <button id="send-button">Send Data to Bot</button>

    <script>
        window.onload = function() {
            const tg = window.Telegram.WebApp;
            tg.ready();

            const displayDiv = document.getElementById('data-display');
            
            // --- RECEIVING DATA FROM THE BOT ---
            const urlParams = new URLSearchParams(window.location.search);
            const userId = urlParams.get('user_id');
            const firstName = urlParams.get('first_name');
            const timestamp = urlParams.get('timestamp'); // NEW: Get the timestamp

            // MODIFIED: Check for the new data and display it
            if (userId && firstName && timestamp) {
                // Convert timestamp back to a readable date
                const date = new Date(parseInt(timestamp) * 1000);
                
                displayDiv.innerHTML = `<b>Data received from bot:</b><br>
                                        User ID: ${userId}<br>
                                        First Name: ${firstName}<br>
                                        <b>Timestamp: ${date.toLocaleString()}</b>`;
            } else {
                displayDiv.innerHTML = "<b>No data received from the bot.</b>";
            }
            
            // --- SENDING DATA TO THE BOT (this part is unchanged) ---
            const sendButton = document.getElementById('send-button');
            sendButton.addEventListener('click', function() {
                const dataToSend = {
                    message: "Hello from the Web App!",
                    status: "ok"
                };
                tg.sendData(JSON.stringify(dataToSend));
            });
        };
    </script>

</body>
</html>